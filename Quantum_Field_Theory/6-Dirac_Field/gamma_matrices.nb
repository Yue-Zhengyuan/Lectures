(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10473,        336]
NotebookOptionsPosition[      9105,        303]
NotebookOutlinePosition[      9502,        319]
CellTagsIndexPosition[      9459,        316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", "1"}
       }], ")"}], ",", 
     RowBox[{"(", GridBox[{
        {"0", "1"},
        {"1", "0"}
       }], ")"}], ",", 
     RowBox[{"(", GridBox[{
        {"0", 
         RowBox[{"-", "\[ImaginaryI]"}]},
        {"\[ImaginaryI]", "0"}
       }], ")"}], ",", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]\[Prime]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", "1"}
       }], ")"}], ",", 
     RowBox[{"-", 
      RowBox[{"(", GridBox[{
         {"0", "1"},
         {"1", "0"}
        }], ")"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", GridBox[{
         {"0", 
          RowBox[{"-", "\[ImaginaryI]"}]},
         {"\[ImaginaryI]", "0"}
        }], ")"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        }], ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"{", 
   RowBox[{"Ep", ",", "0", ",", "0", ",", 
    RowBox[{"-", "p3"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.815972043739674*^9, 3.815972121560595*^9}, {
   3.8160597469398823`*^9, 3.8160597917486887`*^9}, 3.8160604736000834`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"4fef9c41-8ec7-4c27-af33-156ed90c26e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Ep", ",", "0", ",", "0", ",", 
   RowBox[{"-", "p3"}]}], "}"}]], "Output",
 CellChangeTimes->{3.816059798636375*^9, 3.8160604769922333`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"1ad7a01b-45fa-4b5e-ad70-f087603fb863"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "\[Mu]", "]"}], "]"}], 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "\[Nu]", "]"}], "]"}], 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"[", "\[Nu]", "]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.816059566700688*^9, 3.816059638584365*^9}, {
  3.8160597096027393`*^9, 3.816059712773802*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"33616457-1a96-4a58-a858-c23964203464"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Ep", "-", "p3"}], ")"}], "2"], "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Ep", "+", "p3"}], ")"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.816059638908903*^9, 3.816059714337926*^9, {3.816059785901107*^9, 
   3.8160597987082233`*^9}, 3.816060477029957*^9},
 CellLabel->
  "Out[34]//MatrixForm=",ExpressionUUID->"6c4bf07e-2e90-4b06-a3af-\
ed935dfe962f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "\[Mu]", "]"}], "]"}], 
        RowBox[{"\[Sigma]\[Prime]", "[", 
         RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "\[Nu]", "]"}], "]"}], 
        RowBox[{"\[Sigma]\[Prime]", "[", 
         RowBox[{"[", "\[Nu]", "]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.816059776977111*^9, 3.81605977949615*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"4196d4bd-2932-45c5-8736-bc97d568a3f3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Ep", "+", "p3"}], ")"}], "2"], "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Ep", "-", "p3"}], ")"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8160597799480762`*^9, 3.816059798715063*^9}, 
   3.816060477035226*^9},
 CellLabel->
  "Out[35]//MatrixForm=",ExpressionUUID->"50628921-e6ba-4c84-ba9b-\
5cace14b6705"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{"Ep", "+", "p3"}]], "2"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{"Ep", "-", "p3"}]], "2"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}], ",", "2"}], "]"}], 
   "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.816061281875958*^9, 3.816061339193325*^9}, {
  3.816061384340165*^9, 3.816061395880966*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"1ff961bb-8530-43ea-b84e-772082821af6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"Ep", 
      RowBox[{"\[ImaginaryI]", " ", "p3"}]},
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "p3"}], "Ep"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.816061339555368*^9, 3.816061397165271*^9},
 CellLabel->
  "Out[37]//MatrixForm=",ExpressionUUID->"ddf2cbe0-7e96-43df-a4b8-\
ce492bac72f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"[", "\[Mu]", "]"}], "]"}], 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8160614341989107`*^9, 3.816061444684122*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"6e13cc8a-8116-4bce-ad95-85cb5c070800"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Ep", "-", "p3"}], "0"},
     {"0", 
      RowBox[{"Ep", "+", "p3"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8160614370155363`*^9, 3.816061445385441*^9}},
 CellLabel->
  "Out[39]//MatrixForm=",ExpressionUUID->"7aad932c-0b3c-46cc-8eb4-\
77e263b325e7"]
}, Open  ]]
},
WindowSize->{1440, 839},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"ReverseColor.nb",
ExpressionUUID->"5e4f33be-fffc-4814-8e05-953cb01bf83a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1606, 55, 217, "Input",ExpressionUUID->"4fef9c41-8ec7-4c27-af33-156ed90c26e9"],
Cell[2189, 79, 259, 5, 59, "Output",ExpressionUUID->"1ad7a01b-45fa-4b5e-ad70-f087603fb863"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2485, 89, 905, 25, 52, "Input",ExpressionUUID->"33616457-1a96-4a58-a858-c23964203464"],
Cell[3393, 116, 893, 27, 111, "Output",ExpressionUUID->"6c4bf07e-2e90-4b06-a3af-ed935dfe962f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4323, 148, 869, 24, 52, "Input",ExpressionUUID->"4196d4bd-2932-45c5-8736-bc97d568a3f3"],
Cell[5195, 174, 846, 26, 111, "Output",ExpressionUUID->"50628921-e6ba-4c84-ba9b-5cace14b6705"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6078, 205, 994, 29, 129, "Input",ExpressionUUID->"1ff961bb-8530-43ea-b84e-772082821af6"],
Cell[7075, 236, 747, 22, 105, "Output",ExpressionUUID->"ddf2cbe0-7e96-43df-a4b8-ce492bac72f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7859, 263, 523, 14, 52, "Input",ExpressionUUID->"6e13cc8a-8116-4bce-ad95-85cb5c070800"],
Cell[8385, 279, 704, 21, 144, "Output",ExpressionUUID->"7aad932c-0b3c-46cc-8eb4-77e263b325e7"]
}, Open  ]]
}
]
*)

